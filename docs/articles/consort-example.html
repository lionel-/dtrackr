<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dtrackr - Consort statement example • dtrackr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dtrackr - Consort statement example">
<meta property="og:description" content="dtrackr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dtrackr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dtrackr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/consort-example.html">Dtrackr - Consort statement example</a>
    </li>
    <li>
      <a href="../articles/dtrackr-options.html">Dtrackr - configuration example</a>
    </li>
    <li>
      <a href="../articles/joining-pipelines.html">Dtrackr - Joining data pipelines</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="consort-example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dtrackr - Consort statement example</h1>
            
      
      
      <div class="hidden name"><code>consort-example.Rmd</code></div>

    </div>

    
    
<div id="consort-statement" class="section level1">
<h1 class="hasAnchor">
<a href="#consort-statement" class="anchor"></a>CONSORT statement</h1>
<p>CONSORT diagrams are part of the requirements in reporting parallel group clinical trials or case control designs in observational studies. They are described in the updated 2010 CONSORT statement <span class="citation">(1)</span>. They clarify how patients were recruited, selected, randomised and followed up. For observational studies an equivalent requirement is the STROBE statement <span class="citation">(2)</span>. There are other similar requirements for other types of study such as the TRIPOD statement that are applicable for multivariate models <span class="citation">(3)</span>.</p>
<p>As we don’t have to hand a randomised control trial the following example is more geared to reporting observational studies, and uses the Indian Liver Patients disease dataset <span class="citation">(4–6)</span> as an example.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.5     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.1.6     ✔ dplyr   1.0.7</span>
<span class="co">#&gt; ✔ tidyr   1.2.0     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   2.0.2     ✔ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dtrackr</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dtrackr'</span>
<span class="co">#&gt; The following objects are masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     add_count, add_tally, bind_rows</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     comment</span></pre></div>
<p>The Indian liver patients data set has some clinical data on a case control study of patients with and without liver disease. We can use to pretend we are conducting an observational study.</p>
<p>Our study criteria are as follows:</p>
<ul>
<li>Entry criteriais having a total bilirubin &gt;= 0.7 for women or &gt;= 0.8 for men.</li>
<li>Patients must be adults aged between the ages of 18 and 80 inclusive.</li>
</ul>
<p>This can be coded into the <code>dplyr</code> pipeline:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Some useful formatting options</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dtrackr.strata_glue<span class="op">=</span><span class="st">"{tolower(.value)}"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dtrackr.strata_sep<span class="op">=</span><span class="st">", "</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dtrackr.default_message <span class="op">=</span> <span class="st">"{.count} patients"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>dtrackr.default_headline <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="va">ilpd</span> <span class="op">=</span> <span class="fu">dtrackr</span><span class="fu">::</span><span class="va"><a href="../reference/ILPD.html">ILPD</a></span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/capture_exclusions.html">capture_exclusions</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/include_any.html">include_any</a></span><span class="op">(</span>
    <span class="va">Gender</span> <span class="op">==</span> <span class="st">"Female"</span> <span class="op">&amp;</span> <span class="va">Total_Bilirubin</span> <span class="op">&gt;=</span> <span class="fl">0.7</span> <span class="op">~</span> <span class="st">"{.included} women with bili&gt;0.7"</span>,
    <span class="va">Gender</span> <span class="op">==</span> <span class="st">"Male"</span> <span class="op">&amp;</span> <span class="va">Total_Bilirubin</span> <span class="op">&gt;=</span> <span class="fl">0.8</span> <span class="op">~</span> <span class="st">"{.included} men with bili&gt;0.8"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Case_or_Control</span>, .messages<span class="op">=</span><span class="st">"cases versus controls"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/exclude_all.html">exclude_all</a></span><span class="op">(</span>
    <span class="va">Age</span><span class="op">&lt;</span><span class="fl">18</span> <span class="op">~</span> <span class="st">"{.excluded} subjects under 18"</span>,
    <span class="va">Age</span><span class="op">&gt;</span><span class="fl">80</span> <span class="op">~</span> <span class="st">"{.excluded} subjects over 80"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span>.messages <span class="op">=</span> <span class="st">"{.count} after exclusions"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span>
    mean_bili <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%1.2f \u00B1 %1.2f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Total_Bilirubin</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Total_Protein</span><span class="op">)</span><span class="op">)</span>,
    mean_alb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%1.2f \u00B1 %1.2f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Albumin</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Albumin</span><span class="op">)</span><span class="op">)</span>,
    .messages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"bilirubin: {mean_bili}"</span>,
      <span class="st">"albumin: {mean_alb}"</span>
    <span class="op">)</span>                    
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span>.messages <span class="op">=</span> <span class="st">"{.count} in final data set"</span><span class="op">)</span></pre></div>
<p>With a bit of experimentation the flowchart needed for a STROBE/CONSORT checklist can be generated. One option to output the flowchart is SVG which can then be manually formatted as required.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">ilpd</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="353pt" height="336pt" viewbox="0.00 0.00 353.47 335.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 331.6)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-331.6 349.4692,-331.6 349.4692,4 -4,4"></polygon><!-- 10&#45;&gt;12 --><g id="edge2" class="edge"><title>10:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M44.5676,-41.6C44.5676,-41.6 44.5676,-11 44.5676,-11 44.5676,-11 84.8513,-11 84.8513,-11"></path><polygon fill="#000000" stroke="#000000" points="84.8514,-12.7501 89.8513,-11 84.8513,-9.2501 84.8514,-12.7501"></polygon></g><!-- 11&#45;&gt;12 --><g id="edge1" class="edge"><title>11:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M218.5676,-41.6C218.5676,-41.6 218.5676,-11 218.5676,-11 218.5676,-11 178.2839,-11 178.2839,-11"></path><polygon fill="#000000" stroke="#000000" points="178.2839,-9.2501 173.2839,-11 178.2838,-12.7501 178.2839,-9.2501"></polygon></g><!-- 8&#45;&gt;10 --><g id="edge4" class="edge"><title>8:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M44.5676,-97.6C44.5676,-97.6 44.5676,-84.9669 44.5676,-84.9669"></path><polygon fill="#000000" stroke="#000000" points="46.3177,-84.9669 44.5676,-79.9669 42.8177,-84.9669 46.3177,-84.9669"></polygon></g><!-- 9&#45;&gt;11 --><g id="edge3" class="edge"><title>9:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M218.5676,-97.6C218.5676,-97.6 218.5676,-84.9669 218.5676,-84.9669"></path><polygon fill="#000000" stroke="#000000" points="220.3177,-84.9669 218.5676,-79.9669 216.8177,-84.9669 220.3177,-84.9669"></polygon></g><!-- 4&#45;&gt;8 --><g id="edge6" class="edge"><title>4:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M44.5676,-149.6C44.5676,-149.6 44.5676,-132.6493 44.5676,-132.6493"></path><polygon fill="#000000" stroke="#000000" points="46.3177,-132.6493 44.5676,-127.6493 42.8177,-132.6494 46.3177,-132.6493"></polygon></g><!-- 4&#45;&gt;6 --><g id="edge8" class="edge"><title>4:e-&gt;6</title>
<path fill="none" stroke="#000000" d="M73.5676,-164C73.5676,-164 82.3128,-164 82.3128,-164"></path><polygon fill="#000000" stroke="#000000" points="82.3128,-165.7501 87.3128,-164 82.3128,-162.2501 82.3128,-165.7501"></polygon></g><!-- 5&#45;&gt;9 --><g id="edge5" class="edge"><title>5:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M218.5676,-149.6C218.5676,-149.6 218.5676,-132.6493 218.5676,-132.6493"></path><polygon fill="#000000" stroke="#000000" points="220.3177,-132.6493 218.5676,-127.6493 216.8177,-132.6494 220.3177,-132.6493"></polygon></g><!-- 5&#45;&gt;7 --><g id="edge7" class="edge"><title>5:e-&gt;7</title>
<path fill="none" stroke="#000000" d="M247.5676,-164C247.5676,-164 256.6988,-164 256.6988,-164"></path><polygon fill="#000000" stroke="#000000" points="256.6988,-165.7501 261.6988,-164 256.6987,-162.2501 256.6988,-165.7501"></polygon></g><!-- 3&#45;&gt;4 --><g id="edge10" class="edge"><title>3:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M131.5676,-213C131.5676,-213 44.5676,-213 44.5676,-213 44.5676,-213 44.5676,-184.6488 44.5676,-184.6488"></path><polygon fill="#000000" stroke="#000000" points="46.3177,-184.6487 44.5676,-179.6488 42.8177,-184.6488 46.3177,-184.6487"></polygon></g><!-- 3&#45;&gt;5 --><g id="edge9" class="edge"><title>3:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M131.5676,-213C131.5676,-213 218.5676,-213 218.5676,-213 218.5676,-213 218.5676,-184.6488 218.5676,-184.6488"></path><polygon fill="#000000" stroke="#000000" points="220.3177,-184.6487 218.5676,-179.6488 216.8177,-184.6488 220.3177,-184.6487"></polygon></g><!-- 2&#45;&gt;3 --><g id="edge11" class="edge"><title>2:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M131.5676,-243.6C131.5676,-243.6 131.5676,-230.3358 131.5676,-230.3358"></path><polygon fill="#000000" stroke="#000000" points="133.3177,-230.3358 131.5676,-225.3358 129.8177,-230.3359 133.3177,-230.3358"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge12" class="edge"><title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M131.5676,-303.8C131.5676,-303.8 131.5676,-291.0351 131.5676,-291.0351"></path><polygon fill="#000000" stroke="#000000" points="133.3177,-291.0351 131.5676,-286.0351 129.8177,-291.0351 133.3177,-291.0351"></polygon></g><!-- 12 --><g id="node1" class="node"><title>12</title>
<polygon fill="#ffffff" stroke="#000000" points="173.4284,-23.4033 89.7068,-23.4033 89.7068,-.1967 173.4284,-.1967 173.4284,-23.4033"></polygon><text text-anchor="start" x="96.8876" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">460 in final data set</text></g><!-- 10 --><g id="node2" class="node"><title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="89.2029,-79.6 -.0677,-79.6 -.0677,-41.6 89.2029,-41.6 89.2029,-79.6"></polygon><text text-anchor="start" x="7" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">case</text><text text-anchor="start" x="7" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">bilirubin: 4.79 ± 1.07</text><text text-anchor="start" x="7" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">albumin: 3.03 ± 0.78</text></g><!-- 11 --><g id="node3" class="node"><title>11</title>
<polygon fill="#ffffff" stroke="#000000" points="263.2029,-79.6 173.9323,-79.6 173.9323,-41.6 263.2029,-41.6 263.2029,-79.6"></polygon><text text-anchor="start" x="181" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">control</text><text text-anchor="start" x="181" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">bilirubin: 1.35 ± 1.05</text><text text-anchor="start" x="181" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">albumin: 3.38 ± 0.78</text></g><!-- 8 --><g id="node4" class="node"><title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="87.1989,-127.6 1.9363,-127.6 1.9363,-97.6 87.1989,-97.6 87.1989,-127.6"></polygon><text text-anchor="start" x="9.002" y="-114.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">case</text><text text-anchor="start" x="9.002" y="-106.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">344 after exclusions</text></g><!-- 9 --><g id="node5" class="node"><title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="261.1989,-127.6 175.9363,-127.6 175.9363,-97.6 261.1989,-97.6 261.1989,-127.6"></polygon><text text-anchor="start" x="183.002" y="-114.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">control</text><text text-anchor="start" x="183.002" y="-106.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">116 after exclusions</text></g><!-- 4 --><g id="node6" class="node"><title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="73.1444,-179.6 15.9908,-179.6 15.9908,-149.6 73.1444,-149.6 73.1444,-179.6"></polygon><text text-anchor="start" x="22.78" y="-166.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">case</text><text text-anchor="start" x="22.78" y="-158.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">357 patients</text></g><!-- 5 --><g id="node7" class="node"><title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="247.1444,-179.6 189.9908,-179.6 189.9908,-149.6 247.1444,-149.6 247.1444,-179.6"></polygon><text text-anchor="start" x="196.78" y="-166.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">control</text><text text-anchor="start" x="196.78" y="-158.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">125 patients</text></g><!-- 6 --><g id="node8" class="node"><title>6</title>
<polygon fill="#cccccc" stroke="#000000" points="175.8184,-183.6 87.3168,-183.6 87.3168,-145.6 175.8184,-145.6 175.8184,-183.6"></polygon><text text-anchor="start" x="94.4424" y="-170.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">case</text><text text-anchor="start" x="94.4424" y="-162.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">12 subjects under 18</text><text text-anchor="start" x="94.4424" y="-154.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">1 subjects over 80</text></g><!-- 7 --><g id="node9" class="node"><title>7</title>
<polygon fill="#cccccc" stroke="#000000" points="345.371,-183.6 261.7642,-183.6 261.7642,-145.6 345.371,-145.6 345.371,-183.6"></polygon><text text-anchor="start" x="268.666" y="-170.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">control</text><text text-anchor="start" x="268.666" y="-162.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">7 subjects under 18</text><text text-anchor="start" x="268.666" y="-154.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">2 subjects over 80</text></g><!-- 3 --><g id="node10" class="node"><title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="176.9693,-225.0033 86.1659,-225.0033 86.1659,-201.7967 176.9693,-201.7967 176.9693,-225.0033"></polygon><text text-anchor="start" x="93.1168" y="-211" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">cases versus controls</text></g><!-- 2 --><g id="node11" class="node"><title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="181.1421,-285.9005 81.9931,-285.9005 81.9931,-243.2995 181.1421,-243.2995 181.1421,-285.9005"></polygon><text text-anchor="start" x="88.7808" y="-271.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">inclusions:</text><text text-anchor="start" x="88.7808" y="-262.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">128 women with bili&gt;0.7</text><text text-anchor="start" x="88.7808" y="-252.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">354 men with bili&gt;0.8</text></g><!-- 1 --><g id="node12" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="160.1444,-327.4033 102.9908,-327.4033 102.9908,-304.1967 160.1444,-304.1967 160.1444,-327.4033"></polygon><text text-anchor="start" x="109.78" y="-313.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">583 patients</text></g></g></svg>
</div>
<div id="excluded-data" class="section level1">
<h1 class="hasAnchor">
<a href="#excluded-data" class="anchor"></a>Excluded data</h1>
<p>During this pipeline, we may be keen to understand why certain data items are being rejected. This would enable us to examine the source data, and potentially correct it during the data collection process. We’ve used it to allow continuous quality checks on the data to feed back to the data curators, as we regularly conduct analyses. By tracking the exclusions, not only do we track the data flow through the pipeline we also retain all excluded items, with the reason for exclusion. Thus we can reassure ourselves that the exclusions are as expected. We enabled this by calling <code><a href="../reference/capture_exclusions.html">capture_exclusions()</a></code> in the pipeline above. Having tracked the exclusions we can retrieve them by calling <code><a href="../reference/excluded.html">excluded()</a></code> which gives a data frame with the excluded records and the reasons. If the exclusions happened over multiple stages as the dataframe format change in between then this will be held as a nested dataframe (i.e. see <code><a href="https://tidyr.tidyverse.org/reference/nest.html">?tidyr::nest</a></code>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit">

<span class="co"># here we filter out the majority of the actual content of the excluded data to focus on the </span>
<span class="co"># metadata recovered during the exclusion.</span>
<span class="va">ilpd</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/excluded.html">excluded</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">.stage</span>,<span class="va">.message</span>,<span class="va">.filter</span>,<span class="va">Age</span>, <span class="va">Gender</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 22 × 5</span>
<span class="co">#&gt;    .stage  .message             .filter  Age   Gender</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;glue&gt;               &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt;  1 stage 1 7 subjects under 18  Age &lt; 18 17    Male  </span>
<span class="co">#&gt;  2 stage 1 7 subjects under 18  Age &lt; 18 17    Female</span>
<span class="co">#&gt;  3 stage 1 7 subjects under 18  Age &lt; 18 4     Male  </span>
<span class="co">#&gt;  4 stage 1 7 subjects under 18  Age &lt; 18 4     Male  </span>
<span class="co">#&gt;  5 stage 1 7 subjects under 18  Age &lt; 18 14    Male  </span>
<span class="co">#&gt;  6 stage 1 7 subjects under 18  Age &lt; 18 12    Male  </span>
<span class="co">#&gt;  7 stage 1 7 subjects under 18  Age &lt; 18 17    Male  </span>
<span class="co">#&gt;  8 stage 1 12 subjects under 18 Age &lt; 18 14    Male  </span>
<span class="co">#&gt;  9 stage 1 12 subjects under 18 Age &lt; 18 17    Male  </span>
<span class="co">#&gt; 10 stage 1 12 subjects under 18 Age &lt; 18 15    Male  </span>
<span class="co">#&gt; # … with 12 more rows</span></pre></div>
<p>This list may have multiple entries for a single data item, if for example something is excluded in any one step for many reasons.</p>
</div>
<div id="tagging-the-pipeline" class="section level1">
<h1 class="hasAnchor">
<a href="#tagging-the-pipeline" class="anchor"></a>Tagging the pipeline</h1>
<p>For reporting results it is useful to have the numbers from the flowchart to embed into the text of the results section of the write up. Here we show the same pipeline as above, but with 4 uses of the <code>.tag</code> system for labeling part of the pipeline. This captures data in a tag-value list during the pipeline, and retains it as metadata for later reuse.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">

<span class="va">ilpd</span> <span class="op">=</span> <span class="fu">dtrackr</span><span class="fu">::</span><span class="va"><a href="../reference/ILPD.html">ILPD</a></span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span>.tag<span class="op">=</span><span class="st">"initial cohort"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co">#     ^^^^^^^^^^^^^^^^^^^^^</span>
  <span class="fu"><a href="../reference/capture_exclusions.html">capture_exclusions</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/include_any.html">include_any</a></span><span class="op">(</span>
    <span class="va">Gender</span> <span class="op">==</span> <span class="st">"Female"</span> <span class="op">&amp;</span> <span class="va">Total_Bilirubin</span> <span class="op">&gt;=</span> <span class="fl">0.7</span> <span class="op">~</span> <span class="st">"{.included} women with bili&gt;0.7"</span>,
    <span class="va">Gender</span> <span class="op">==</span> <span class="st">"Male"</span> <span class="op">&amp;</span> <span class="va">Total_Bilirubin</span> <span class="op">&gt;=</span> <span class="fl">0.8</span> <span class="op">~</span> <span class="st">"{.included} men with bili&gt;0.8"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Case_or_Control</span>, .messages<span class="op">=</span><span class="st">"cases versus controls"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span>.tag<span class="op">=</span><span class="st">"study cohort"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co">#       ^^^^^^^^^^^^^^^^^^^</span>
  <span class="fu"><a href="../reference/exclude_all.html">exclude_all</a></span><span class="op">(</span>
    <span class="va">Age</span><span class="op">&lt;</span><span class="fl">18</span> <span class="op">~</span> <span class="st">"{.excluded} subjects under 18"</span>,
    <span class="va">Age</span><span class="op">&gt;</span><span class="fl">80</span> <span class="op">~</span> <span class="st">"{.excluded} subjects over 80"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span>.messages <span class="op">=</span> <span class="st">"{.count} after exclusions"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span>
    mean_bili <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%1.2f \u00B1 %1.2f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Total_Bilirubin</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Total_Protein</span><span class="op">)</span><span class="op">)</span>,
    mean_alb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%1.2f \u00B1 %1.2f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Albumin</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Albumin</span><span class="op">)</span><span class="op">)</span>,
    .messages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"bilirubin: {mean_bili}"</span>,
      <span class="st">"albumin: {mean_alb}"</span>
    <span class="op">)</span>,
    .tag <span class="op">=</span> <span class="st">"qualifying patients"</span>
  <span class="co"># ^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span>.messages <span class="op">=</span> <span class="st">"{.count} in final data set"</span>, .tag<span class="op">=</span><span class="st">"final set"</span><span class="op">)</span>
  <span class="co">#                                                 ^^^^^^^^^^^^^^^^</span></pre></div>
<p>This metadata can be retrieved as follows, which will give you all metadata for all 4 points in the pipeline:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">ilpd</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tagged.html">tagged</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">.content</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 7</span>
<span class="co">#&gt;   .tag                .count .total .strata   Case_or_Control mean_bili mean_alb</span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt;  &lt;int&gt; &lt;chr&gt;     &lt;ord&gt;           &lt;chr&gt;     &lt;chr&gt;   </span>
<span class="co">#&gt; 1 initial cohort         583    583 ""        &lt;NA&gt;            &lt;NA&gt;      &lt;NA&gt;    </span>
<span class="co">#&gt; 2 study cohort           357    482 "case"    case            &lt;NA&gt;      &lt;NA&gt;    </span>
<span class="co">#&gt; 3 study cohort           125    482 "control" control         &lt;NA&gt;      &lt;NA&gt;    </span>
<span class="co">#&gt; 4 qualifying patients    344    460 "case"    case            4.79 ± 1… 3.03 ± …</span>
<span class="co">#&gt; 5 qualifying patients    116    460 "control" control         1.35 ± 1… 3.38 ± …</span>
<span class="co">#&gt; 6 final set              460    460 ""        &lt;NA&gt;            &lt;NA&gt;      &lt;NA&gt;</span></pre></div>
<p>More often though you will want to retrieve specific values from specific points for the results text for example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">initialSet</span> <span class="op">=</span> <span class="va">ilpd</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tagged.html">tagged</a></span><span class="op">(</span>.tag <span class="op">=</span> <span class="st">"initial cohort"</span>, .glue <span class="op">=</span> <span class="st">"{.count} patients"</span><span class="op">)</span>
<span class="va">finalSet</span> <span class="op">=</span> <span class="va">ilpd</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tagged.html">tagged</a></span><span class="op">(</span>.tag <span class="op">=</span> <span class="st">"final set"</span>, .glue <span class="op">=</span> <span class="st">"{.count} patients"</span><span class="op">)</span>

<span class="co"># there were `r initialSet` in the study, of whom `r finalSet` met the eligibility criteria.</span></pre></div>
<p>For example there were 583 patients in the study, of whom 460 patients met the eligibility criteria.</p>
<p>More complex formatting and calculations are possible including those that happen on a per group basis, and pull in values from elsewhere.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">ilpd</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tagged.html">tagged</a></span><span class="op">(</span>
    .tag <span class="op">=</span> <span class="st">"qualifying patients"</span>, 
    .glue <span class="op">=</span> <span class="st">"{.strata}: {.count}/{.total} ({sprintf('%1.1f', .count/.total*100)}%) patients on {sysDate}, with a mean bilirubin of {mean_bili}"</span>, 
    sysDate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>
    <span class="co"># we could have any number of other parameters here from the global environment</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">.label</span><span class="op">)</span>
<span class="co">#&gt; case: 344/460 (74.8%) patients on 2022-06-27, with a mean bilirubin of 4.79 ± 1.07</span>
<span class="co">#&gt; control: 116/460 (25.2%) patients on 2022-06-27, with a mean bilirubin of 1.35 ± 1.05</span></pre></div>
<p>Sometimes it will be necessary to operate on all tagged content at once. This is possible but be aware that the content available depends somewhat on where the tag was set in the pipeline so not all fields will always be present (although <code>.count</code> and <code>.total</code> will be). The <code>.total</code> is the overall number of cases at that point in the pipeline. <code>.count</code> is the number of cases in each strata.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">ilpd</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tagged.html">tagged</a></span><span class="op">(</span>.glue <span class="op">=</span> <span class="st">"{.count}/{.total} patients"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   .tag                .strata   .label          </span>
<span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;     &lt;glue&gt;          </span>
<span class="co">#&gt; 1 initial cohort      ""        583/583 patients</span>
<span class="co">#&gt; 2 study cohort        "case"    357/482 patients</span>
<span class="co">#&gt; 3 study cohort        "control" 125/482 patients</span>
<span class="co">#&gt; 4 qualifying patients "case"    344/460 patients</span>
<span class="co">#&gt; 5 qualifying patients "control" 116/460 patients</span>
<span class="co">#&gt; 6 final set           ""        460/460 patients</span></pre></div>
<p>For comparing different stages in the pipeline the following example may be useful which compares counts at different stages of the pipeline.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">ilpd</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/tagged.html">tagged</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># selects only top level content</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">.content</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.tag</span>, <span class="va">.total</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>values_from<span class="op">=</span><span class="va">.total</span>, names_from<span class="op">=</span><span class="va">.tag</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue_data</a></span><span class="op">(</span><span class="st">"Out of {`initial cohort`} patients, {`study cohort`} were eligible for inclusion on the basis of their liver function tests but {`study cohort`-`qualifying patients`} were 
                  outside the age limits. This left {`final set`} patients included in the final study (i.e. overall {`initial cohort`-`final set`} were removed)."</span><span class="op">)</span>
<span class="co">#&gt; Out of 583 patients, 482 were eligible for inclusion on the basis of their liver function tests but 22 were </span>
<span class="co">#&gt; outside the age limits. This left 460 patients included in the final study (i.e. overall 123 were removed).</span></pre></div>
<div id="refs">
<div id="ref-schulzCONSORT2010Statement2010">
<p>1. Schulz KF, Altman DG, Moher D. CONSORT 2010 Statement: Updated guidelines for reporting parallel group randomised trials. BMJ. 2010 Mar 24;340:c332. </p>
</div>
<div id="ref-vonelmStrengtheningReportingObservational2008">
<p>2. von Elm E, Altman DG, Egger M, Pocock SJ, Gøtzsche PC, Vandenbroucke JP, et al. The Strengthening the Reporting of Observational Studies in Epidemiology (STROBE) statement: Guidelines for reporting observational studies. J Clin Epidemiol. 2008 Apr;61(4):344–9. </p>
</div>
<div id="ref-collinsTransparentReportingMultivariable2015">
<p>3. Collins GS, Reitsma JB, Altman DG, Moons KG. Transparent reporting of a multivariable prediction model for individual prognosis or diagnosis (TRIPOD): The TRIPOD Statement. BMC Medicine. 2015 Jan 6;13(1):1. </p>
</div>
<div id="ref-ramanaCriticalComparativeStudy">
<p>4. Ramana BV, Venkateswarlu PNB, Pradesh A. A Critical Comparative Study of Liver Patients from USA and INDIA: An Exploratory Analysis. </p>
</div>
<div id="ref-ramanaCriticalStudySelected2011">
<p>5. Ramana B, Babu M, Venkateswarlu N. A Critical Study of Selected Classification Algorithms for Liver Disease Diagnosis. 2011; </p>
</div>
<div id="ref-Dua2019">
<p>6. Dua D, Graff C. UCI machine learning repository [Internet]. University of California, Irvine, School of Information and Computer Sciences; 2017. Available from: <a href="http://archive.ics.uci.edu/ml">http://archive.ics.uci.edu/ml</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert Challen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
